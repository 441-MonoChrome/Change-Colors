<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"> 
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en"> 
<head>
<link rel="stylesheet" type="text/css" href="css/pop_up.css" /> 
<script>



function ChangeBtnState(BtnId, BtnText, BindFunction, overrideType, path, blnOverriden, overrideFn){
    var btn = document.getElementById(BtnId);
    btn.innerHTML = BtnText;
    if(path != null){
	btn.onclick = function(){BindFunction.call(overrideType, path); DisplayButtons();};
    }
    else{
	btn.onclick = function(){BindFunction.call(overrideType, blnOverriden, overrideFn); DisplayButtons();};
    }	
}

function DisplayButtons(){
    var BackgroundPage = chrome.extension.getBackgroundPage();
    var objPage = BackgroundPage.objCurrentPage;
    var objPageOverrides = BackgroundPage.objCurrentPage.blnOverrides;
    var currentUrl = objPage.Url;
    var currentDomain = objPage.Domain;
    
    
    if(objPageOverrides['OverridenPages']){
	ChangeBtnState('pageOverriden', 'Remove override on this page', objPage.removeOverride, 'OverridenPages', currentUrl);
    }
    else{
	ChangeBtnState('pageOverriden', 'Apply override on this page', objPage.applyOverride, 'OverridenPages', currentUrl);
    }
    
    if(objPageOverrides['OverridenDomains']){
	ChangeBtnState('domainOverriden', 'Remove override on this domain', objPage.removeOverride, 'OverridenDomains', currentDomain);
    }
    else{
	ChangeBtnState('domainOverriden', 'Apply override on this domain', objPage.applyOverride, 'OverridenDomains', currentDomain);
    }

    if(objPageOverrides.OverrideAll){
	if(BackgroundPage.IsNotPageOverriden){
	    ChangeBtnState('pageOverriden', 'Global override on this page', objPage.removeOverride, 'NotOverridenPages', currentUrl);
	}
	else{
	    ChangeBtnState('pageOverriden', 'No global override on this page', objPage.applyOverride, 'NotOverridenPages', currentUrl);
	}

	if(BackgroundPage.IsNotDomainOverriden){
	    ChangeBtnState('domainOverriden', 'Global override on this domain', objPage.removeOverride, 'NotOverridenDomains', currentDomain);
	}
	else{
	    ChangeBtnState('domainOverriden', 'No global override on this domain', objPage.applyOverride, 'NotOverridenDomains', currentDomain);
	}
	ChangeBtnState('overrideAll', 'Remove override on all pages', objPage.removeOverride, null, false, objPage.callRemoveCss);
    }
    else{
	ChangeBtnState('overrideAll', 'Apply override to all pages', objPage.applyOverride, null, true, objPage.callInjectCss);
    }
}

</script>
</head>
<body onLoad="DisplayButtons()">
    <div>
      <div id="pageOverriden" class="action_btn" onClick=""></div>
      <div id="domainOverriden" class="action_btn" onClick=""></div>
      <div id="overrideAll" class="action_btn" onClick=""></div>
    </div>
</body>
</html>
